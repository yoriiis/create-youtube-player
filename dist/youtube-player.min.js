/**
 * @license MIT
 * @name create-youtube-player
 * @version 2.0.0
 * @author: Yoriiis aka Joris DANIEL <joris.daniel@gmail.com>
 * @description: Easy way to load and manage multiple Youtube players with API
 * {@link https://github.com/yoriiis/create-youtube-player}
 * @copyright 2019 Joris DANIEL
 **/

"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var YoutubePlayer=function(){function e(t){_classCallCheck(this,e),this.options=Object.assign({multiplePlaying:!0},t||{}),this.youtubeAPIReady=!1,this.players=[],this.playerOnPlaying=[]}return _createClass(e,[{key:"loadAPI",value:function(e){var t=this;window.onYouTubeIframeAPIReady=function(){t.youtubeAPIReady=!0,"function"==typeof e&&e()};var a=document.createElement("script");a.src="https://www.youtube.com/iframe_api",a.async=!0,document.getElementsByTagName("body")[0].appendChild(a)}},{key:"create",value:function(e){var t=this,a=Object.assign({element:null,width:"100%",height:"100%",playerVars:{showinfo:0,modestbranding:0,autohide:0,rel:0,wmode:"transparent",controls:1},selectors:{posterWrapper:".player-poster"},events:{}},e||{}),n=(new Date).getTime(),r="youtube-".concat(n);a.element.YT_ID=r,a.element.insertAdjacentHTML("afterbegin",'<div id="'.concat(r,'" class="yt-iframe"></div>')),this.players.push(new YT.Player(r,{videoId:a.element.getAttribute("data-youtube-id"),width:a.width,height:a.height,playerVars:a.playerVars,events:{onReady:function(e){"function"==typeof a.events.onPlayerReady&&a.events.onPlayerReady(e)},onStateChange:function(e){1===e.data?t.playerOnPlaying.push(r):t.updateArrayPlayersPlaying(r),t.options.multiplePlaying||1!==e.data||t.pauseOtherVideo(r),"function"==typeof a.events.onStateChange?a.events.onStateChange(e):0===e.data&&!1!==o&&(o.style.display="block")}}}));var o=a.element.querySelector(a.selectors.posterWrapper);null!==o&&o.addEventListener("click",function(e){e.preventDefault();var t=YT.get(e.currentTarget.parentNode.YT_ID);"function"==typeof a.events.onPosterClick?a.events.onPosterClick(e,t):(t.playVideo(),e.currentTarget.style.display="none")})}},{key:"updateArrayPlayersPlaying",value:function(e){var t=this;this.playerOnPlaying.forEach(function(a,n){a===e&&t.playerOnPlaying.splice(n,1)})}},{key:"pauseOtherVideo",value:function(e){this.playerOnPlaying.length&&this.playerOnPlaying.forEach(function(t){t!==e&&YT.get(t).pauseVideo()})}}]),e}(),_default=YoutubePlayer;exports.default=_default,module.exports=exports.default;